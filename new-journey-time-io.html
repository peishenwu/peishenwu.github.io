<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新旅程復健科診所 :: 線上打卡系統</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            background-color: #f8f9fa;
        }
        #status {
            margin: 20px;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-width: 600px;
            text-align: center;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        #error-message {
            display: none;
            text-align: center;
            padding: 20px;
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            margin: 20px;
            width: 80%;
            max-width: 600px;
        }
        .loading {
            background-color: #fff3cd;
            color: #856404;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
        }
        .button {
            margin-top: 15px;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.2s;
        }
        .primary-button {
            background-color: #007bff;
            color: white;
        }
        .primary-button:hover {
            background-color: #0056b3;
        }
        .secondary-button {
            background-color: #6c757d;
            color: white;
            margin-left: 10px;
        }
        .secondary-button:hover {
            background-color: #545b62;
        }
        .button-group {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        .code-display {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            word-break: break-all;
            font-family: monospace;
        }
        .note {
            margin-top: 15px;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div id="status" class="loading">正在取得位置資訊...</div>
    <div id="error-message">
        打卡系統需要取得您的GPS位置才能進行打卡。
        <br>請允許位置存取權限後重試。
    </div>
    <button id="retry-button" onclick="getLocation()" class="button primary-button" style="display: none;">重新取得位置</button>

    <script>
function _0x400f(_0xc6de51,_0x1cd9e5){const _0x2b4396=_0x2b43();return _0x400f=function(_0x400f61,_0x176dff){_0x400f61=_0x400f61-0x1a3;let _0x36a69e=_0x2b4396[_0x400f61];return _0x36a69e;},_0x400f(_0xc6de51,_0x1cd9e5);}const _0x3c690d=_0x400f;(function(_0x5682d3,_0x3daa80){const _0x8a43fc=_0x400f,_0x3de82d=_0x5682d3();while(!![]){try{const _0x493dc3=-parseInt(_0x8a43fc(0x1a3))/0x1+parseInt(_0x8a43fc(0x1a8))/0x2*(parseInt(_0x8a43fc(0x1b4))/0x3)+parseInt(_0x8a43fc(0x1bb))/0x4+parseInt(_0x8a43fc(0x1c7))/0x5+parseInt(_0x8a43fc(0x1ad))/0x6*(-parseInt(_0x8a43fc(0x1d0))/0x7)+-parseInt(_0x8a43fc(0x1a7))/0x8*(parseInt(_0x8a43fc(0x1a5))/0x9)+-parseInt(_0x8a43fc(0x1ce))/0xa*(-parseInt(_0x8a43fc(0x1d4))/0xb);if(_0x493dc3===_0x3daa80)break;else _0x3de82d['push'](_0x3de82d['shift']());}catch(_0x2ab36b){_0x3de82d['push'](_0x3de82d['shift']());}}}(_0x2b43,0xb03bc));const statusDiv=document[_0x3c690d(0x1c0)]('status'),errorMessage=document[_0x3c690d(0x1c0)](_0x3c690d(0x1d5)),retryButton=document[_0x3c690d(0x1c0)](_0x3c690d(0x1d1)),baseUrl=_0x3c690d(0x1c8);function getCurrentDateNumber(){const _0x3cdc66=_0x3c690d,_0x174e50=new Date(),_0x3bfb50=_0x174e50[_0x3cdc66(0x1bc)](),_0x1f2deb=String(_0x174e50['getMonth']()+0x1)['padStart'](0x2,'0'),_0x614d14=String(_0x174e50[_0x3cdc66(0x1ae)]())['padStart'](0x2,'0');return parseInt(''+_0x3bfb50+_0x1f2deb+_0x614d14);}function encodeCoordinates(_0x553720,_0x473f36){const _0x482f8d=_0x3c690d,_0xf4503b=getCurrentDateNumber(),_0x4c90cc=Math['round'](_0x553720*0xf4240),_0x3b7de6=Math[_0x482f8d(0x1cf)](_0x473f36*0xf4240),_0x4bd8bc=_0x4c90cc*(_0xf4503b%0x7e3),_0x197d50=_0x3b7de6*(_0xf4503b%0x7e3),_0x4c80ef=_0x4bd8bc[_0x482f8d(0x1c5)](0x10)[_0x482f8d(0x1c2)](),_0x395101=_0x197d50['toString'](0x10)['toUpperCase']();return _0x4c80ef+'_'+_0x395101;}function copyToClipboard(_0x2dd9d2){const _0x1e80d5=_0x3c690d;navigator['clipboard'][_0x1e80d5(0x1c6)](_0x2dd9d2)[_0x1e80d5(0x1d2)](()=>{const _0x5efefc=_0x1e80d5,_0x27c822=document[_0x5efefc(0x1c0)](_0x5efefc(0x1bf));_0x27c822[_0x5efefc(0x1b7)]=_0x5efefc(0x1ca),setTimeout(()=>{const _0x4c521f=_0x5efefc;_0x27c822[_0x4c521f(0x1b7)]=_0x4c521f(0x1a9);},0x7d0);},_0x49511c=>{const _0x31de14=_0x1e80d5;console[_0x31de14(0x1b2)](_0x31de14(0x1c3),_0x49511c);});}function goToForm(_0x1afbca,_0x346f2b){const _0x137b08=_0x3c690d;window[_0x137b08(0x1cc)][_0x137b08(0x1c9)]=_0x1afbca;}function getLocation(){const _0x340274=_0x3c690d;errorMessage[_0x340274(0x1ac)][_0x340274(0x1d3)]=_0x340274(0x1af),retryButton[_0x340274(0x1ac)]['display']='none',statusDiv[_0x340274(0x1aa)]=_0x340274(0x1b6),statusDiv[_0x340274(0x1ac)][_0x340274(0x1d3)]=_0x340274(0x1b0),statusDiv['textContent']='正在取得位置資訊...';if(!navigator[_0x340274(0x1b3)]){showError(_0x340274(0x1c1));return;}navigator[_0x340274(0x1b3)][_0x340274(0x1c4)](_0x4a1c0c=>{const _0x2d3f0c=_0x340274,{latitude:_0x1b69d5,longitude:_0x4099e3}=_0x4a1c0c[_0x2d3f0c(0x1b5)],_0x36b241=encodeCoordinates(_0x1b69d5,_0x4099e3),_0x2ee852=baseUrl+_0x2d3f0c(0x1be)+_0x36b241;statusDiv['className']=_0x2d3f0c(0x1a4),statusDiv[_0x2d3f0c(0x1bd)]=_0x2d3f0c(0x1cb)+_0x2ee852+'\x27,\x20\x27'+_0x36b241+'\x27)\x22\x20class=\x22button\x20primary-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20前往打卡頁面\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22note\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20如果座標驗證碼沒有自動帶入，請複製以下驗證碼：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22code-display\x22>'+_0x36b241+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22copyButton\x22\x20onclick=\x22copyToClipboard(\x27'+_0x36b241+'\x27)\x22\x20class=\x22button\x20secondary-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20複製座標驗證碼\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>';},_0x1f0604=>{const _0x59994d=_0x340274;let _0x511df9;switch(_0x1f0604[_0x59994d(0x1b9)]){case _0x1f0604['PERMISSION_DENIED']:_0x511df9=_0x59994d(0x1b1);break;case _0x1f0604[_0x59994d(0x1a6)]:_0x511df9='無法取得地理位置資訊';break;case _0x1f0604[_0x59994d(0x1ab)]:_0x511df9=_0x59994d(0x1b8);break;default:_0x511df9=_0x59994d(0x1ba);}showError(_0x511df9);},{'enableHighAccuracy':!![],'timeout':0x1388,'maximumAge':0x0});}function showError(_0x13b187){const _0x673eae=_0x3c690d;statusDiv[_0x673eae(0x1ac)][_0x673eae(0x1d3)]=_0x673eae(0x1af),errorMessage[_0x673eae(0x1ac)][_0x673eae(0x1d3)]=_0x673eae(0x1b0),retryButton[_0x673eae(0x1ac)]['display']=_0x673eae(0x1b0);}window[_0x3c690d(0x1cd)]=getLocation;function _0x2b43(){const _0x1426cc=['getCurrentPosition','toString','writeText','4613875amWqQU','https://docs.google.com/forms/d/e/1FAIpQLSd2ZvdJdRk3F0NorQhnbTpJ6xgUvnZTl_I3LXnidLQZpELkhQ/viewform','href','已複製！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>成功取得位置資訊！</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22note\x22>注意：進入打卡頁面需要登入\x20Gmail\x20帳號</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22button-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22goToForm(\x27','location','onload','370OnppBZ','round','105VAbMlh','retry-button','then','display','500302JkSdga','error-message','1386668FSkuDJ','success','1792431NJpvYH','POSITION_UNAVAILABLE','40bhoKAZ','398VGpwxB','複製座標驗證碼','className','TIMEOUT','style','473388jaUdxc','getDate','none','block','需要位置權限才能進行打卡','error','geolocation','12777dTfHFw','coords','loading','textContent','取得地理位置資訊超時','code','發生未知錯誤','3338540wKqNjK','getFullYear','innerHTML','?usp=pp_url&entry.27118168=','copyButton','getElementById','您的瀏覽器不支援地理位置功能','toUpperCase','無法複製文字:\x20'];_0x2b43=function(){return _0x1426cc;};return _0x2b43();}
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新旅程復健科診所 :: 線上打卡系統</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            background-color: #f8f9fa;
        }
        #status {
            margin: 20px;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-width: 600px;
            text-align: center;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        #error-message {
            display: none;
            text-align: center;
            padding: 20px;
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            margin: 20px;
            width: 80%;
            max-width: 600px;
        }
        .loading {
            background-color: #fff3cd;
            color: #856404;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
        }
        .button {
            margin-top: 15px;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.2s;
        }
        .primary-button {
            background-color: #007bff;
            color: white;
        }
        .primary-button:hover {
            background-color: #0056b3;
        }
        .secondary-button {
            background-color: #6c757d;
            color: white;
            margin-left: 10px;
        }
        .secondary-button:hover {
            background-color: #545b62;
        }
        .button-group {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        .code-display {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            word-break: break-all;
            font-family: monospace;
        }
        .note {
            margin-top: 15px;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div id="status" class="loading">正在取得位置資訊...</div>
    <div id="error-message">
        打卡系統需要取得您的GPS位置才能進行打卡。
        <br>請允許位置存取權限後重試。
    </div>
    <button id="retry-button" onclick="getLocation()" class="button primary-button" style="display: none;">重新取得位置</button>

    <script>
const _0x2c091b=_0x2eee;(function(_0x20900c,_0x41c1df){const _0x3b1563=_0x2eee,_0xae9d33=_0x20900c();while(!![]){try{const _0x5674bd=-parseInt(_0x3b1563(0x15d))/0x1*(parseInt(_0x3b1563(0x135))/0x2)+parseInt(_0x3b1563(0x158))/0x3*(parseInt(_0x3b1563(0x163))/0x4)+parseInt(_0x3b1563(0x13b))/0x5+-parseInt(_0x3b1563(0x15f))/0x6*(-parseInt(_0x3b1563(0x14d))/0x7)+parseInt(_0x3b1563(0x153))/0x8+parseInt(_0x3b1563(0x155))/0x9+parseInt(_0x3b1563(0x13f))/0xa*(-parseInt(_0x3b1563(0x146))/0xb);if(_0x5674bd===_0x41c1df)break;else _0xae9d33['push'](_0xae9d33['shift']());}catch(_0x4426c8){_0xae9d33['push'](_0xae9d33['shift']());}}}(_0x17d5,0xe170e));const statusDiv=document[_0x2c091b(0x138)](_0x2c091b(0x140)),errorMessage=document[_0x2c091b(0x138)](_0x2c091b(0x147)),retryButton=document[_0x2c091b(0x138)](_0x2c091b(0x154)),baseUrl=_0x2c091b(0x143);function getCurrentDateNumber(){const _0x1459a3=_0x2c091b,_0x352773=new Date(),_0x4998fc=_0x352773[_0x1459a3(0x145)](),_0x53c28d=String(_0x352773['getMonth']()+0x1)[_0x1459a3(0x14a)](0x2,'0'),_0x49616e=String(_0x352773[_0x1459a3(0x161)]())['padStart'](0x2,'0');return parseInt(''+_0x4998fc+_0x53c28d+_0x49616e);}function _0x17d5(){const _0x2fb6c3=['5607hUObaT','getCurrentPosition','none','TIMEOUT','無法取得地理位置資訊','需要位置權限才能進行打卡','3697136tOCVQV','retry-button','14941854ZebkVV','style','clipboard','25929tPbkLG','取得地理位置資訊超時','round','onload','\x27,\x20\x27','1292656vUQlOO','複製座標驗證碼','9138kakjyv','href','getDate','location','436nsrUuu','?usp=pp_url&entry.27118168=','\x27)\x22\x20class=\x22button\x20secondary-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20複製座標驗證碼\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>成功取得位置資訊！</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22note\x22>注意：進入打卡頁面需要登入\x20Gmail\x20帳號</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22button-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22goToForm(\x27','display','block','PERMISSION_DENIED','className','2ffbcVJ','success','copyButton','getElementById','toString','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22copyButton\x22\x20onclick=\x22copyToClipboard(\x27','2825375xSeDCL','textContent','geolocation','正在取得位置資訊...','130AMZzfO','status','innerHTML','toUpperCase','https://docs.google.com/forms/d/e/1FAIpQLSd2ZvdJdRk3F0NorQhnbTpJ6xgUvnZTl_I3LXnidLQZpELkhQ/viewform','您的瀏覽器不支援地理位置功能','getFullYear','2228237NEKQbc','error-message','已複製！','then','padStart','error','code'];_0x17d5=function(){return _0x2fb6c3;};return _0x17d5();}function _0x2eee(_0x2b0f3e,_0x4d5d35){const _0x17d549=_0x17d5();return _0x2eee=function(_0x2eeeff,_0x5142e0){_0x2eeeff=_0x2eeeff-0x131;let _0x33a547=_0x17d549[_0x2eeeff];return _0x33a547;},_0x2eee(_0x2b0f3e,_0x4d5d35);}function encodeCoordinates(_0x12deb7,_0x916680){const _0x26a831=_0x2c091b,_0x4d0162=getCurrentDateNumber(),_0x9c46e=Math[_0x26a831(0x15a)](_0x12deb7*0xf4240),_0x34f960=Math['round'](_0x916680*0xf4240),_0x49d901=_0x9c46e+_0x4d0162,_0x5aed16=_0x34f960+_0x4d0162,_0x52da02=_0x49d901[_0x26a831(0x139)](0x10)[_0x26a831(0x142)](),_0x2d6941=_0x5aed16[_0x26a831(0x139)](0x10)[_0x26a831(0x142)]();return _0x52da02+'_'+_0x2d6941;}function copyToClipboard(_0x413199){const _0x162db1=_0x2c091b;navigator[_0x162db1(0x157)]['writeText'](_0x413199)[_0x162db1(0x149)](()=>{const _0x1f9718=_0x162db1,_0x28464c=document[_0x1f9718(0x138)](_0x1f9718(0x137));_0x28464c['textContent']=_0x1f9718(0x148),setTimeout(()=>{const _0x334c85=_0x1f9718;_0x28464c['textContent']=_0x334c85(0x15e);},0x7d0);},_0x3e5b80=>{const _0x116c8b=_0x162db1;console[_0x116c8b(0x14b)]('無法複製文字:\x20',_0x3e5b80);});}function goToForm(_0x4cc15b,_0x48f421){const _0x13b76d=_0x2c091b;window[_0x13b76d(0x162)][_0x13b76d(0x160)]=_0x4cc15b;}function getLocation(){const _0x460934=_0x2c091b;errorMessage['style'][_0x460934(0x131)]=_0x460934(0x14f),retryButton[_0x460934(0x156)][_0x460934(0x131)]=_0x460934(0x14f),statusDiv[_0x460934(0x134)]='loading',statusDiv[_0x460934(0x156)]['display']='block',statusDiv[_0x460934(0x13c)]=_0x460934(0x13e);if(!navigator[_0x460934(0x13d)]){showError(_0x460934(0x144));return;}navigator['geolocation'][_0x460934(0x14e)](_0x1a81e2=>{const _0x1032ed=_0x460934,{latitude:_0x111073,longitude:_0x4dad92}=_0x1a81e2['coords'],_0x3070fa=encodeCoordinates(_0x111073,_0x4dad92),_0x39d316=baseUrl+_0x1032ed(0x164)+_0x3070fa;statusDiv[_0x1032ed(0x134)]=_0x1032ed(0x136),statusDiv[_0x1032ed(0x141)]=_0x1032ed(0x166)+_0x39d316+_0x1032ed(0x15c)+_0x3070fa+'\x27)\x22\x20class=\x22button\x20primary-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20前往打卡頁面\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22note\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20如果座標驗證碼沒有自動帶入，請複製以下驗證碼：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22code-display\x22>'+_0x3070fa+_0x1032ed(0x13a)+_0x3070fa+_0x1032ed(0x165);},_0x1a2b57=>{const _0x534e9c=_0x460934;let _0x2cfcd1;switch(_0x1a2b57[_0x534e9c(0x14c)]){case _0x1a2b57[_0x534e9c(0x133)]:_0x2cfcd1=_0x534e9c(0x152);break;case _0x1a2b57['POSITION_UNAVAILABLE']:_0x2cfcd1=_0x534e9c(0x151);break;case _0x1a2b57[_0x534e9c(0x150)]:_0x2cfcd1=_0x534e9c(0x159);break;default:_0x2cfcd1='發生未知錯誤';}showError(_0x2cfcd1);},{'enableHighAccuracy':!![],'timeout':0x1388,'maximumAge':0x0});}function showError(_0x2c9e09){const _0x20a9a5=_0x2c091b;statusDiv['style'][_0x20a9a5(0x131)]=_0x20a9a5(0x14f),errorMessage[_0x20a9a5(0x156)]['display']=_0x20a9a5(0x132),retryButton[_0x20a9a5(0x156)]['display']='block';}window[_0x2c091b(0x15b)]=getLocation;
    </script>
</body>
</html>

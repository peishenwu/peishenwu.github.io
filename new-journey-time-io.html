<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新旅程復健科診所 :: 線上打卡系統</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            background-color: #f8f9fa;
        }
        #status {
            margin: 20px;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-width: 600px;
            text-align: center;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        #error-message {
            display: none;
            text-align: center;
            padding: 20px;
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            margin: 20px;
            width: 80%;
            max-width: 600px;
        }
        .loading {
            background-color: #fff3cd;
            color: #856404;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
        }
        .button {
            margin-top: 15px;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.2s;
        }
        .primary-button {
            background-color: #007bff;
            color: white;
        }
        .primary-button:hover {
            background-color: #0056b3;
        }
        .secondary-button {
            background-color: #6c757d;
            color: white;
            margin-left: 10px;
        }
        .secondary-button:hover {
            background-color: #545b62;
        }
        .button-group {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        .code-display {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            word-break: break-all;
            font-family: monospace;
        }
        .note {
            margin-top: 15px;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div id="status" class="loading">正在取得位置資訊...</div>
    <div id="error-message">
        打卡系統需要取得您的GPS位置才能進行打卡。
        <br>請允許位置存取權限後重試。
    </div>
    <button id="retry-button" onclick="getLocation()" class="button primary-button" style="display: none;">重新取得位置</button>

    <script>
const _0x543608=_0x4262;(function(_0x3a1d2e,_0x255ded){const _0x5268d4=_0x4262,_0xdf1b15=_0x3a1d2e();while(!![]){try{const _0x127cf6=parseInt(_0x5268d4(0x1d3))/0x1*(-parseInt(_0x5268d4(0x1aa))/0x2)+parseInt(_0x5268d4(0x1c0))/0x3*(-parseInt(_0x5268d4(0x1cf))/0x4)+parseInt(_0x5268d4(0x1ac))/0x5+-parseInt(_0x5268d4(0x1a9))/0x6+-parseInt(_0x5268d4(0x1a5))/0x7*(parseInt(_0x5268d4(0x1c4))/0x8)+parseInt(_0x5268d4(0x1c9))/0x9*(parseInt(_0x5268d4(0x1d0))/0xa)+parseInt(_0x5268d4(0x1b7))/0xb*(parseInt(_0x5268d4(0x1ba))/0xc);if(_0x127cf6===_0x255ded)break;else _0xdf1b15['push'](_0xdf1b15['shift']());}catch(_0x320c17){_0xdf1b15['push'](_0xdf1b15['shift']());}}}(_0x20ca,0xca572));const statusDiv=document['getElementById'](_0x543608(0x1b9)),errorMessage=document[_0x543608(0x1a1)](_0x543608(0x1d4)),retryButton=document[_0x543608(0x1a1)]('retry-button'),baseUrl=_0x543608(0x1a3);function getCurrentDateNumber(){const _0x5ef85e=_0x543608,_0x465517=new Date(),_0x541a84=_0x465517[_0x5ef85e(0x1ca)](),_0xed28ee=String(_0x465517[_0x5ef85e(0x1ad)]()+0x1)[_0x5ef85e(0x1b3)](0x2,'0'),_0x10e3f2=String(_0x465517[_0x5ef85e(0x1cd)]())[_0x5ef85e(0x1b3)](0x2,'0');return parseInt(''+_0x541a84+_0xed28ee+_0x10e3f2);}function encodeCoordinates(_0x223f5d,_0x583c9f){const _0x19c449=_0x543608,_0x29cef7=getCurrentDateNumber(),_0x2e6410=Math['round'](_0x223f5d*0xf4240),_0x33a244=Math[_0x19c449(0x1ce)](_0x583c9f*0xf4240),_0x322894=_0x2e6410*_0x29cef7,_0x2cb512=_0x33a244*_0x29cef7,_0x5d5d88=_0x322894[_0x19c449(0x1ae)](0x10)['toUpperCase'](),_0x3b8dea=_0x2cb512['toString'](0x10)[_0x19c449(0x1b6)]();return _0x5d5d88+'_'+_0x3b8dea;}function _0x20ca(){const _0x68a688=['copyButton','code','success','\x27,\x20\x27','570219BJoUYM','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>成功取得位置資訊！</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22note\x22>注意：進入打卡頁面需要登入\x20Gmail\x20帳號</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22button-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22goToForm(\x27','block','?usp=pp_url&entry.27118168=','8pMybRu','coords','innerHTML','href','TIMEOUT','40491NaVCoV','getFullYear','display','textContent','getDate','round','28tYJqGd','2230lPnCnq','發生未知錯誤','geolocation','1723UKwIKK','error-message','getElementById','\x27)\x22\x20class=\x22button\x20primary-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20前往打卡頁面\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22note\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20如果座標驗證碼沒有自動帶入，請複製以下驗證碼：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22code-display\x22>','https://docs.google.com/forms/d/e/1FAIpQLSd2ZvdJdRk3F0NorQhnbTpJ6xgUvnZTl_I3LXnidLQZpELkhQ/viewform','then','10757341ueFPAl','error','loading','需要位置權限才能進行打卡','6705360MeLXOp','1642CXGIwa','none','2860865bwoYiH','getMonth','toString','正在取得位置資訊...','className','\x27)\x22\x20class=\x22button\x20secondary-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20複製座標驗證碼\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>','getCurrentPosition','padStart','style','您的瀏覽器不支援地理位置功能','toUpperCase','51180283OijQQP','已複製！','status','12EswQZS','無法取得地理位置資訊'];_0x20ca=function(){return _0x68a688;};return _0x20ca();}function copyToClipboard(_0x43ce2a){const _0x17e519=_0x543608;navigator['clipboard']['writeText'](_0x43ce2a)[_0x17e519(0x1a4)](()=>{const _0x3fea5d=_0x17e519,_0x3da285=document[_0x3fea5d(0x1a1)](_0x3fea5d(0x1bc));_0x3da285[_0x3fea5d(0x1cc)]=_0x3fea5d(0x1b8),setTimeout(()=>{const _0x166740=_0x3fea5d;_0x3da285[_0x166740(0x1cc)]='複製座標驗證碼';},0x7d0);},_0x4470b6=>{const _0x51b714=_0x17e519;console[_0x51b714(0x1a6)]('無法複製文字:\x20',_0x4470b6);});}function goToForm(_0x354f7c,_0x4fa795){const _0x5c268d=_0x543608;window['location'][_0x5c268d(0x1c7)]=_0x354f7c;}function getLocation(){const _0x301d72=_0x543608;errorMessage['style'][_0x301d72(0x1cb)]=_0x301d72(0x1ab),retryButton[_0x301d72(0x1b4)][_0x301d72(0x1cb)]=_0x301d72(0x1ab),statusDiv[_0x301d72(0x1b0)]=_0x301d72(0x1a7),statusDiv[_0x301d72(0x1b4)][_0x301d72(0x1cb)]='block',statusDiv[_0x301d72(0x1cc)]=_0x301d72(0x1af);if(!navigator[_0x301d72(0x1d2)]){showError(_0x301d72(0x1b5));return;}navigator[_0x301d72(0x1d2)][_0x301d72(0x1b2)](_0x54c484=>{const _0x4acc70=_0x301d72,{latitude:_0x11b568,longitude:_0x2b0d02}=_0x54c484[_0x4acc70(0x1c5)],_0x43886f=encodeCoordinates(_0x11b568,_0x2b0d02),_0x5d1be3=baseUrl+_0x4acc70(0x1c3)+_0x43886f;statusDiv[_0x4acc70(0x1b0)]=_0x4acc70(0x1be),statusDiv[_0x4acc70(0x1c6)]=_0x4acc70(0x1c1)+_0x5d1be3+_0x4acc70(0x1bf)+_0x43886f+_0x4acc70(0x1a2)+_0x43886f+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22copyButton\x22\x20onclick=\x22copyToClipboard(\x27'+_0x43886f+_0x4acc70(0x1b1);},_0x500705=>{const _0x1c0d6c=_0x301d72;let _0x2918b2;switch(_0x500705[_0x1c0d6c(0x1bd)]){case _0x500705['PERMISSION_DENIED']:_0x2918b2=_0x1c0d6c(0x1a8);break;case _0x500705['POSITION_UNAVAILABLE']:_0x2918b2=_0x1c0d6c(0x1bb);break;case _0x500705[_0x1c0d6c(0x1c8)]:_0x2918b2='取得地理位置資訊超時';break;default:_0x2918b2=_0x1c0d6c(0x1d1);}showError(_0x2918b2);},{'enableHighAccuracy':!![],'timeout':0x1388,'maximumAge':0x0});}function _0x4262(_0x30a679,_0x50c880){const _0x20cafd=_0x20ca();return _0x4262=function(_0x4262bd,_0x1f4dcf){_0x4262bd=_0x4262bd-0x1a1;let _0xdc87f0=_0x20cafd[_0x4262bd];return _0xdc87f0;},_0x4262(_0x30a679,_0x50c880);}function showError(_0x33e60b){const _0x2d3983=_0x543608;statusDiv['style'][_0x2d3983(0x1cb)]=_0x2d3983(0x1ab),errorMessage['style'][_0x2d3983(0x1cb)]=_0x2d3983(0x1c2),retryButton[_0x2d3983(0x1b4)][_0x2d3983(0x1cb)]=_0x2d3983(0x1c2);}window['onload']=getLocation;
    </script>
</body>
</html>

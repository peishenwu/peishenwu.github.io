<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新旅程復健科診所 :: 線上打卡系統</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            background-color: #f8f9fa;
        }
        #status {
            margin: 20px;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-width: 600px;
            text-align: center;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        #error-message {
            display: none;
            text-align: center;
            padding: 20px;
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            margin: 20px;
            width: 80%;
            max-width: 600px;
        }
        .loading {
            background-color: #fff3cd;
            color: #856404;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
        }
        .button {
            margin-top: 15px;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.2s;
        }
        .primary-button {
            background-color: #007bff;
            color: white;
        }
        .primary-button:hover {
            background-color: #0056b3;
        }
        .secondary-button {
            background-color: #6c757d;
            color: white;
            margin-left: 10px;
        }
        .secondary-button:hover {
            background-color: #545b62;
        }
        .button-group {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        .code-display {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            word-break: break-all;
            font-family: monospace;
        }
        .note {
            margin-top: 15px;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div id="status" class="loading">正在取得位置資訊...</div>
    <div id="error-message">
        打卡系統需要取得您的GPS位置才能進行打卡。
        <br>請允許位置存取權限後重試。
    </div>
    <button id="retry-button" onclick="getLocation()" class="button primary-button" style="display: none;">重新取得位置</button>

    <script>
function _0x2472(){const _0x476b67=['textContent','error-message','location','810411DlnGKR','getCurrentPosition','toString','2346205wIwveV','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>成功取得位置資訊！</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22note\x22>注意：進入打卡頁面需要登入\x20Gmail\x20帳號</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22button-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22goToForm(\x27','\x27)\x22\x20class=\x22button\x20secondary-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20複製座標驗證碼\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>','1556zUExdE','4375773SMoLEG','loading','display','80dijBNi','clipboard','code','getMonth','7995ZFiYlx','round','block','status','2953638mmZIXF','retry-button','geolocation','copyButton','writeText','正在取得位置資訊...','TIMEOUT','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22copyButton\x22\x20onclick=\x22copyToClipboard(\x27','getElementById','您的瀏覽器不支援地理位置功能','5626592bNnCij','POSITION_UNAVAILABLE','toUpperCase','11439444Tjaljm','7cVFulq','無法取得地理位置資訊','?usp=pp_url&entry.27118168=','none','複製座標驗證碼','success','style','PERMISSION_DENIED','padStart','已複製！','發生未知錯誤','innerHTML','無法複製文字:\x20','error','className'];_0x2472=function(){return _0x476b67;};return _0x2472();}const _0x1f504a=_0x3bff;(function(_0x1623c5,_0xa5bb){const _0x1de898=_0x3bff,_0x488fab=_0x1623c5();while(!![]){try{const _0xf72dd0=-parseInt(_0x1de898(0x16c))/0x1+-parseInt(_0x1de898(0x17e))/0x2+parseInt(_0x1de898(0x17a))/0x3*(parseInt(_0x1de898(0x172))/0x4)+-parseInt(_0x1de898(0x16f))/0x5+-parseInt(_0x1de898(0x159))/0x6+parseInt(_0x1de898(0x15a))/0x7*(parseInt(_0x1de898(0x156))/0x8)+parseInt(_0x1de898(0x173))/0x9*(parseInt(_0x1de898(0x176))/0xa);if(_0xf72dd0===_0xa5bb)break;else _0x488fab['push'](_0x488fab['shift']());}catch(_0x268135){_0x488fab['push'](_0x488fab['shift']());}}}(_0x2472,0xebf8c));const statusDiv=document[_0x1f504a(0x154)](_0x1f504a(0x17d)),errorMessage=document[_0x1f504a(0x154)](_0x1f504a(0x16a)),retryButton=document['getElementById'](_0x1f504a(0x17f)),baseUrl='https://docs.google.com/forms/d/e/1FAIpQLSd2ZvdJdRk3F0NorQhnbTpJ6xgUvnZTl_I3LXnidLQZpELkhQ/viewform';function getCurrentDateNumber(){const _0x4cc552=_0x1f504a,_0x148fe2=new Date(),_0x1560f2=_0x148fe2['getFullYear'](),_0x4bb241=String(_0x148fe2[_0x4cc552(0x179)]()+0x1)[_0x4cc552(0x162)](0x2,'0'),_0x392e88=String(_0x148fe2['getDate']())[_0x4cc552(0x162)](0x2,'0');return parseInt(''+_0x1560f2+_0x4bb241+_0x392e88);}function encodeCoordinates(_0x303e67,_0x3ba3da){const _0x5eb721=_0x1f504a,_0x208fcf=getCurrentDateNumber(),_0x50ad3e=Math[_0x5eb721(0x17b)](_0x303e67*0xf4240),_0x4820f4=Math[_0x5eb721(0x17b)](_0x3ba3da*0xf4240),_0x133bdc=_0x50ad3e+0xf4240*(_0x208fcf%0x7),_0x217e42=_0x4820f4+0xf4240*(_0x208fcf%0x7),_0x3ed61a=_0x133bdc[_0x5eb721(0x16e)](0x10)[_0x5eb721(0x158)](),_0xf41029=_0x217e42[_0x5eb721(0x16e)](0x10)[_0x5eb721(0x158)]();return _0x3ed61a+'_'+_0xf41029;}function copyToClipboard(_0x7af78d){const _0x4d1ced=_0x1f504a;navigator[_0x4d1ced(0x177)][_0x4d1ced(0x150)](_0x7af78d)['then'](()=>{const _0x118a95=_0x4d1ced,_0x26efe4=document[_0x118a95(0x154)](_0x118a95(0x14f));_0x26efe4['textContent']=_0x118a95(0x163),setTimeout(()=>{const _0xb8d8dc=_0x118a95;_0x26efe4[_0xb8d8dc(0x169)]=_0xb8d8dc(0x15e);},0x7d0);},_0x16ac79=>{const _0x38e79a=_0x4d1ced;console[_0x38e79a(0x167)](_0x38e79a(0x166),_0x16ac79);});}function goToForm(_0x3f684b,_0x19ba4e){const _0x38406e=_0x1f504a;window[_0x38406e(0x16b)]['href']=_0x3f684b;}function getLocation(){const _0x55a09b=_0x1f504a;errorMessage[_0x55a09b(0x160)][_0x55a09b(0x175)]=_0x55a09b(0x15d),retryButton[_0x55a09b(0x160)][_0x55a09b(0x175)]='none',statusDiv['className']=_0x55a09b(0x174),statusDiv[_0x55a09b(0x160)][_0x55a09b(0x175)]=_0x55a09b(0x17c),statusDiv[_0x55a09b(0x169)]=_0x55a09b(0x151);if(!navigator[_0x55a09b(0x180)]){showError(_0x55a09b(0x155));return;}navigator[_0x55a09b(0x180)][_0x55a09b(0x16d)](_0x1421d0=>{const _0x33e052=_0x55a09b,{latitude:_0x5df57f,longitude:_0x169269}=_0x1421d0['coords'],_0x502ed0=encodeCoordinates(_0x5df57f,_0x169269),_0x5611ed=baseUrl+_0x33e052(0x15c)+_0x502ed0;statusDiv[_0x33e052(0x168)]=_0x33e052(0x15f),statusDiv[_0x33e052(0x165)]=_0x33e052(0x170)+_0x5611ed+'\x27,\x20\x27'+_0x502ed0+'\x27)\x22\x20class=\x22button\x20primary-button\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20前往打卡頁面\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22note\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20如果座標驗證碼沒有自動帶入，請複製以下驗證碼：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22code-display\x22>'+_0x502ed0+_0x33e052(0x153)+_0x502ed0+_0x33e052(0x171);},_0x38427a=>{const _0x5df8aa=_0x55a09b;let _0x492022;switch(_0x38427a[_0x5df8aa(0x178)]){case _0x38427a[_0x5df8aa(0x161)]:_0x492022='需要位置權限才能進行打卡';break;case _0x38427a[_0x5df8aa(0x157)]:_0x492022=_0x5df8aa(0x15b);break;case _0x38427a[_0x5df8aa(0x152)]:_0x492022='取得地理位置資訊超時';break;default:_0x492022=_0x5df8aa(0x164);}showError(_0x492022);},{'enableHighAccuracy':!![],'timeout':0x1388,'maximumAge':0x0});}function _0x3bff(_0x595ec7,_0x22a814){const _0x247220=_0x2472();return _0x3bff=function(_0x3bffab,_0x32f0f5){_0x3bffab=_0x3bffab-0x14f;let _0x127fd1=_0x247220[_0x3bffab];return _0x127fd1;},_0x3bff(_0x595ec7,_0x22a814);}function showError(_0x504ce4){const _0xde4a62=_0x1f504a;statusDiv['style'][_0xde4a62(0x175)]=_0xde4a62(0x15d),errorMessage['style'][_0xde4a62(0x175)]=_0xde4a62(0x17c),retryButton['style']['display']=_0xde4a62(0x17c);}window['onload']=getLocation;
    </script>
</body>
</html>
